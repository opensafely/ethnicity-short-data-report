geom_stratum(width = 2/5, discern = TRUE) +
geom_text(stat = "stratum", discern = TRUE, aes(label = after_stat(stratum)))
gg +
geom_alluvium(aes(fill = as.factor(student)), width = 2/5, discern = FALSE) +
geom_stratum(width = 2/5, discern = FALSE) +
geom_text(stat = "stratum", discern = FALSE, aes(label = after_stat(stratum)))
#
gg <- ggplot(majors_alluvia,
aes(axis1 = CURR1, axis2 = CURR7, axis3 = CURR13))
gg +
geom_alluvium(aes(fill = as.factor(student)), width = 2/5, discern = TRUE) +
geom_stratum(width = 2/5, discern = TRUE) +
geom_text(stat = "stratum", discern = TRUE, aes(label = after_stat(stratum)))
gg +
geom_alluvium(aes(fill = as.factor(student)), width = 2/5, discern = TRUE) +
geom_stratum(width = 2/5, discern = FALSE) +
geom_text(stat = "stratum", discern = FALSE, aes(label = after_stat(stratum)))
#
datalong <-read_csv(here::here("output","input_eth.csv"))
datalong3<-datalong %>%
select(starts_with("eth_")) %>%
mutate(across(where(is.numeric), ~+as.logical(.x))) %>%
rowwise() %>%
mutate(across(everything(), ~case_when(. == 1 ~ cur_column()), .names = 'new_{col}'))%>%
mutate(ethnicities = sum(c_across(starts_with("eth_")), na.rm = T)) %>%
unite(New_Col, starts_with('new_'), na.rm = TRUE, sep = ',')
datalong3<-datalong3%>%
separate("New_Col",fill="right",sep = ',',into=c(paste0("col_",1:max(datalong3$ethnicities))))  %>%
mutate(across(starts_with("col"), ~ ifelse(is.na(.), coalesce(!!!select(., rev(starts_with("col")))), .))) %>%
na_if("") %>% drop_na(col_1)
data2 <- datalong3 %>% count(across(starts_with("col")))%>%
mutate(id = row_number())
data3
data4 <- data3 %>%
mutate(wave = as.numeric(str_remove(value, "col_")),
key=case_when(
key == "Eth_1" ~ "White British",
key == "Eth_2" ~ "White Irish",
key == "Eth_3" ~ "Other White",
key == "Eth_4" ~ "White and Black Caribbean",
key == "Eth_5" ~ "White and Black African",
key == "Eth_6" ~ "White and Asian",
key == "Eth_7" ~ "Other Mixed",
key == "Eth_8" ~ "Indian",
key == "Eth_9" ~ "Pakistani",
key == "Eth_10" ~ "Bangladeshi",
key == "Eth_11" ~ "Other Asian",
key == "Eth_12" ~ "Caribbean",
key == "Eth_13" ~ "African",
key == "Eth_14" ~ "Other Black",
key == "Eth_15" ~ "Chinese",
key == "Eth_16" ~ "Any other ethnic group"),
key = as.factor(key),
key = fct_relevel(key, "White British", "White Irish","Other White",
"White and Black Caribbean","White and Black African","White and Asian","Other Mixed",
"Indian","Pakistani","Bangladeshi","Other Asian",
"Caribbean","African","Other Black",
"Chinese","Any other ethnic group")  )
plot <- ggplot(data4, aes(x = wave, y = n,
stratum = key, fill = key,
alluvium = id)) +
geom_stratum(alpha = .5) +
geom_flow() +
scale_fill_manual(values=c("red1","red3","red4", "blue1","blue3","blue4","darkslateblue", "chartreuse","chartreuse3","chartreuse4","darkgreen","yellow1","yellow2","yellow4","deeppink","deeppink4"))
plot
View(data4)
datalong <-read_csv(here::here("output","input_eth.csv"))
View(datalong)
datalong3<-datalong %>%
select(starts_with("eth_")) %>%
mutate(across(where(is.numeric), ~+as.logical(.x))) %>%
rowwise() %>%
mutate(across(everything(), ~case_when(. == 1 ~ cur_column()), .names = 'new_{col}'))%>%
mutate(ethnicities = sum(c_across(starts_with("eth_")), na.rm = T)) %>%
unite(New_Col, starts_with('new_'), na.rm = TRUE, sep = ',')
View(datalong3)
datalong3<-datalong3%>%
separate("New_Col",fill="right",sep = ',',into=c(paste0("col_",1:max(datalong3$ethnicities))))  %>%
mutate(across(starts_with("col"), ~ ifelse(is.na(.), coalesce(!!!select(., rev(starts_with("col")))), .))) %>%
na_if("") %>% drop_na(col_1)
data2 <- datalong3 %>% count(across(starts_with("col")))%>%
mutate(id = row_number())
View(data2)
? count
data2 <- datalong3 %>%
summarise(id = row_number(),
n = ethnicities)
data3 <- gather(data2, value, key, -n, -id)
data4 <- data3 %>%
mutate(wave = as.numeric(str_remove(value, "col_")),
key=case_when(
key == "Eth_1" ~ "White British",
key == "Eth_2" ~ "White Irish",
key == "Eth_3" ~ "Other White",
key == "Eth_4" ~ "White and Black Caribbean",
key == "Eth_5" ~ "White and Black African",
key == "Eth_6" ~ "White and Asian",
key == "Eth_7" ~ "Other Mixed",
key == "Eth_8" ~ "Indian",
key == "Eth_9" ~ "Pakistani",
key == "Eth_10" ~ "Bangladeshi",
key == "Eth_11" ~ "Other Asian",
key == "Eth_12" ~ "Caribbean",
key == "Eth_13" ~ "African",
key == "Eth_14" ~ "Other Black",
key == "Eth_15" ~ "Chinese",
key == "Eth_16" ~ "Any other ethnic group"),
key = as.factor(key),
key = fct_relevel(key, "White British", "White Irish","Other White",
"White and Black Caribbean","White and Black African","White and Asian","Other Mixed",
"Indian","Pakistani","Bangladeshi","Other Asian",
"Caribbean","African","Other Black",
"Chinese","Any other ethnic group")  )
data2 <- datalong3 %>%
mutate(id = row_number()) %>%
rename(
"n" = "ethnicities")
data3 <- gather(data2, value, key, -n, -id)
data4 <- data3 %>%
mutate(wave = as.numeric(str_remove(value, "col_")),
key=case_when(
key == "Eth_1" ~ "White British",
key == "Eth_2" ~ "White Irish",
key == "Eth_3" ~ "Other White",
key == "Eth_4" ~ "White and Black Caribbean",
key == "Eth_5" ~ "White and Black African",
key == "Eth_6" ~ "White and Asian",
key == "Eth_7" ~ "Other Mixed",
key == "Eth_8" ~ "Indian",
key == "Eth_9" ~ "Pakistani",
key == "Eth_10" ~ "Bangladeshi",
key == "Eth_11" ~ "Other Asian",
key == "Eth_12" ~ "Caribbean",
key == "Eth_13" ~ "African",
key == "Eth_14" ~ "Other Black",
key == "Eth_15" ~ "Chinese",
key == "Eth_16" ~ "Any other ethnic group"),
key = as.factor(key),
key = fct_relevel(key, "White British", "White Irish","Other White",
"White and Black Caribbean","White and Black African","White and Asian","Other Mixed",
"Indian","Pakistani","Bangladeshi","Other Asian",
"Caribbean","African","Other Black",
"Chinese","Any other ethnic group")  )
data2 <- datalong3 %>% count(across(starts_with("col")))%>%
mutate(id = row_number())
head(data2)
data2 <- datalong3 %>%
mutate(id = row_number()) %>%
rename("n" = "ethnicities") %>%
select(start_with("col"),id,n)
data2 <- datalong3 %>%
mutate(id = row_number()) %>%
rename("n" = "ethnicities") %>%
select(starts_with("col"),id,n)
data3 <- gather(data2, value, key, -n, -id)
data4 <- data3 %>%
mutate(wave = as.numeric(str_remove(value, "col_")),
key=case_when(
key == "Eth_1" ~ "White British",
key == "Eth_2" ~ "White Irish",
key == "Eth_3" ~ "Other White",
key == "Eth_4" ~ "White and Black Caribbean",
key == "Eth_5" ~ "White and Black African",
key == "Eth_6" ~ "White and Asian",
key == "Eth_7" ~ "Other Mixed",
key == "Eth_8" ~ "Indian",
key == "Eth_9" ~ "Pakistani",
key == "Eth_10" ~ "Bangladeshi",
key == "Eth_11" ~ "Other Asian",
key == "Eth_12" ~ "Caribbean",
key == "Eth_13" ~ "African",
key == "Eth_14" ~ "Other Black",
key == "Eth_15" ~ "Chinese",
key == "Eth_16" ~ "Any other ethnic group"),
key = as.factor(key),
key = fct_relevel(key, "White British", "White Irish","Other White",
"White and Black Caribbean","White and Black African","White and Asian","Other Mixed",
"Indian","Pakistani","Bangladeshi","Other Asian",
"Caribbean","African","Other Black",
"Chinese","Any other ethnic group")  )
plot <- ggplot(data4, aes(x = wave, y = n,
stratum = key, fill = key,
alluvium = id)) +
geom_stratum(alpha = .5) +
geom_flow() +
scale_fill_manual(values=c("red1","red3","red4", "blue1","blue3","blue4","darkslateblue", "chartreuse","chartreuse3","chartreuse4","darkgreen","yellow1","yellow2","yellow4","deeppink","deeppink4"))
plot
data2 <- datalong3 %>% count(across(starts_with("col")))%>%
mutate(id = row_number())
data2 <- datalong3 %>% count(across(starts_with("col")))%>%
mutate(id = row_number())
data2[which(data$col_1=="Eth_1" & data$col_11=="Eth_1"),]
data2[,which(data$col_1=="Eth_1" & data$col_11=="Eth_1")]
data2[,which(data2$col_1=="Eth_1" & data2$col_11=="Eth_1")]
data2[which(data2$col_1=="Eth_1" & data2$col_11=="Eth_1"),]
View(data2[which(data2$col_1=="Eth_1" & data2$col_11=="Eth_1"),])
a<-c(c(1,2,3),c(1,2,3),c(1,2,3))
a
a<-cbind.data.frame(c(1,2,3),c(1,2,3),c(1,2,3))
a
a %>% count()
a<-cbind.data.frame(a=c(1,2,3),b=c(1,2,3),c=c(1,2,3))
a
a %>% count()
a<-cbind.data.frame(a=c(1,2,3),b=c(1,3,3),c=c(1,2,3))
a
a %>% count()
a<-cbind.data.frame(a1=c(1,2,3),a2=c(1,3,3),c=c(1,2,3))
a %>% count(across(starts_with("a")))
a
a<-cbind.data.frame(a1=c(1,2,1),a2=c(1,3,3),c=c(1,2,1))
a %>% count(across(starts_with("a")))
a
a<-cbind.data.frame(a1=c(1,2,1),a2=c(1,3,1),c=c(1,2,1))
a
a %>% count(across(starts_with("a")))
data3 <- gather(data2, value, key, -n, -id)
data4 <- data3 %>%
mutate(wave = as.numeric(str_remove(value, "col_")),
key=case_when(
key == "Eth_1" ~ "White British",
key == "Eth_2" ~ "White Irish",
key == "Eth_3" ~ "Other White",
key == "Eth_4" ~ "White and Black Caribbean",
key == "Eth_5" ~ "White and Black African",
key == "Eth_6" ~ "White and Asian",
key == "Eth_7" ~ "Other Mixed",
key == "Eth_8" ~ "Indian",
key == "Eth_9" ~ "Pakistani",
key == "Eth_10" ~ "Bangladeshi",
key == "Eth_11" ~ "Other Asian",
key == "Eth_12" ~ "Caribbean",
key == "Eth_13" ~ "African",
key == "Eth_14" ~ "Other Black",
key == "Eth_15" ~ "Chinese",
key == "Eth_16" ~ "Any other ethnic group"),
key = as.factor(key),
key = fct_relevel(key, "White British", "White Irish","Other White",
"White and Black Caribbean","White and Black African","White and Asian","Other Mixed",
"Indian","Pakistani","Bangladeshi","Other Asian",
"Caribbean","African","Other Black",
"Chinese","Any other ethnic group")  )
plot <- ggplot(data4, aes(x = wave, y = n,
stratum = key, fill = key,
alluvium = id)) +
geom_stratum(alpha = .5) +
geom_flow() +
scale_fill_manual(values=c("red1","red3","red4", "blue1","blue3","blue4","darkslateblue", "chartreuse","chartreuse3","chartreuse4","darkgreen","yellow1","yellow2","yellow4","deeppink","deeppink4"))
plot
data2 <- datalong3 %>% count(across(starts_with("col")))%>%
mutate(id = row_number(),
n=round(n/5)*5,)
data3 <- gather(data2, value, key, -n, -id)
data4 <- data3 %>%
mutate(wave = as.numeric(str_remove(value, "col_")),
key=case_when(
key == "Eth_1" ~ "White British",
key == "Eth_2" ~ "White Irish",
key == "Eth_3" ~ "Other White",
key == "Eth_4" ~ "White and Black Caribbean",
key == "Eth_5" ~ "White and Black African",
key == "Eth_6" ~ "White and Asian",
key == "Eth_7" ~ "Other Mixed",
key == "Eth_8" ~ "Indian",
key == "Eth_9" ~ "Pakistani",
key == "Eth_10" ~ "Bangladeshi",
key == "Eth_11" ~ "Other Asian",
key == "Eth_12" ~ "Caribbean",
key == "Eth_13" ~ "African",
key == "Eth_14" ~ "Other Black",
key == "Eth_15" ~ "Chinese",
key == "Eth_16" ~ "Any other ethnic group"),
key = as.factor(key),
key = fct_relevel(key, "White British", "White Irish","Other White",
"White and Black Caribbean","White and Black African","White and Asian","Other Mixed",
"Indian","Pakistani","Bangladeshi","Other Asian",
"Caribbean","African","Other Black",
"Chinese","Any other ethnic group")  )
plot <- ggplot(data4, aes(x = wave, y = n,
stratum = key, fill = key,
alluvium = id)) +
geom_stratum(alpha = .5) +
geom_flow() +
scale_fill_manual(values=c("red1","red3","red4", "blue1","blue3","blue4","darkslateblue", "chartreuse","chartreuse3","chartreuse4","darkgreen","yellow1","yellow2","yellow4","deeppink","deeppink4"))
>>>>>>> Stashed changes
ggsave(
filename = here::here("output", "plots", "alluvial.png"),
alluvial,
dpi = 200,
width = 30,
height = 15,
units = "cm"
)
alluvial2<-alluvial_data %>%
drop_na(common) %>%
select(common,rank,patient_id) %>%
ggplot(
aes(x = rank, stratum = common, alluvium = patient_id,
fill = common, label = common)) +
scale_fill_brewer(type = "qual", palette = "Set2") +
geom_flow(stat = "alluvium", lode.guidance = "frontback",
color = "darkgray") +
geom_alluvium(aes(fill=common,alpha=0.5)) +
geom_stratum() +
theme(legend.position = "bottom") +
ggtitle("Ethnicity")
ggsave(
filename = here::here("output", "plots", "alluvial2.png"),
alluvial2,
dpi = 200,
width = 30,
height = 15,
units = "cm"
)
<<<<<<< Updated upstream
alluvial_data %>%
select(ethnicity_snomed_5 ,common) %>%
tbl_summary(by= ethnicity_snomed_5) %>%
modify_header(all_stat_cols() ~ "N={n}<br>({style_percent(p)}%)")
matches_full_table <- matches %>%
select(ethnicity_snomed_5,common) %>%
rename("this"="ethnicity_snomed_5")
tbl_summary(by= ethnicity_snomed_5,
label = list(common ~ "Most frequent",ethnicity_snomed_5 ~ "Latest")) %>%
bold_labels()
df_tab<-alluvial_data %>%
drop_na(common,ethnicity_snomed_5) %>%
group_by(ethnicity_snomed_5) %>%
mutate(n=n_distinct(patient_id),ethnicity_snomed_5=paste0(ethnicity_snomed_5,": N=",n)) %>%
select(ethnicity_snomed_5,common) %>%
tbl_summary(by= common,percent = "row")
,list(all_categorical() ~ "{n}"))
df_tab
df_tab<-alluvial_data %>%
drop_na(common,ethnicity_snomed_5) %>%
group_by(ethnicity_snomed_5) %>%
mutate(n=n_distinct(patient_id),ethnicity_snomed_5=paste0(ethnicity_snomed_5,": N=",n)) %>%
select(ethnicity_snomed_5,common) %>%
tbl_summary(by= common,statistic = all_categorical() ~ "{N}")
df_tab
df_tab<-alluvial_data %>%
drop_na(common,ethnicity_snomed_5) %>%
group_by(ethnicity_snomed_5) %>%
mutate(n=n_distinct(patient_id),ethnicity_snomed_5=paste0(ethnicity_snomed_5,": N=",n)) %>%
select(ethnicity_snomed_5,common) %>%
tbl_summary(by= common,statistic = all_categorical() ~ "{n}")
df_tab
=======
dataInp <- files %>%
map(function(x)
# # import data
read_csv(here::here("output",x)) %>%
pivot_longer(
cols = starts_with("eth_"),
names_to = "snomedcode",
names_prefix = "eth_",
values_to = "count",
values_drop_na = TRUE
) %>%
group_by(snomedcode) %>%
summarise(snomedcode_count=sum(count))) %>%
reduce(rbind)
library('tidyverse')
library('sf')
files=dir(here::here("output"),pattern = "input")
files
read_csv(here::here("output","input.csv"))
read_csv(here::here("output","input.csv")) %>% View()
read_csv(here::here("output","input.csv")) %>%   pivot_longer(
cols = starts_with("eth_"),
names_to = "snomedcode",
names_prefix = "eth_",
values_to = "count",
values_drop_na = TRUE
)
read_csv(here::here("output","input.csv")) %>%   pivot_longer(
cols = starts_with("eth_"),
names_to = "snomedcode",
names_prefix = "eth_",
values_to = "count",
values_drop_na = TRUE
) %>% View()
group_by(snomedcode) %>%
summarise(snomedcode_count=sum(count)))
read_csv(here::here("output","input.csv")) %>%   pivot_longer(
cols = starts_with("eth_"),
names_to = "snomedcode",
names_prefix = "eth_",
values_to = "count",
values_drop_na = TRUE
) %>%    group_by(snomedcode) %>%
summarise(snomedcode_count=sum(count)))
read_csv(here::here("output","input.csv")) %>%   pivot_longer(
cols = starts_with("eth_"),
names_to = "snomedcode",
names_prefix = "eth_",
values_to = "count",
values_drop_na = TRUE
) %>%    group_by(snomedcode) %>%
summarise(snomedcode_count=sum(count))
fs::dir_create(here::here("output"))
df_input <- read_csv(here::here("output","input.csv.gz")) %>%
mutate(ethnicity_snomed_5=ifelse(ethnicity_snomed_5==0,NA, ethnicity_snomed_5),
total_ctv3 = ifelse(is.na(ethnicity_5),0, 1),
total_primis = ifelse(is.na(ethnicity_snomed_5), 0, 1),
total_primis_unk = ifelse(is.na(ethnicity_primis_5_unk), 0, 1)
)
registered <- df_input %>%
filter(registered==1) %>%
summarise(ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk))
all<- df_input%>%
summarise(ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk)) %>%
bind_rows(registered)
all<-as.data.frame(all)
rownames(all) <- c("All patients","Registered patients")
### count non-missing ethnicities for CTV3 and Primis codelist
library('tidyverse')
fs::dir_create(here::here("output"))
df_input <- read_csv(here::here("output","input.csv.gz")) %>%
mutate(ethnicity_snomed_5=ifelse(ethnicity_snomed_5==0,NA, ethnicity_snomed_5),
total_ctv3 = ifelse(is.na(ethnicity_5),0, 1),
total_primis = ifelse(is.na(ethnicity_snomed_5), 0, 1),
total_primis_unk = ifelse(is.na(ethnicity_primis_5_unk), 0, 1)
)
registered <- df_input %>%
filter(registered==1) %>%
summarise(ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk))
all<- df_input%>%
summarise(ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk)) %>%
bind_rows(registered)
all<-as.data.frame(all)
rownames(all) <- c("All patients","Registered patients")
all
all<- df_input%>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk)) %>%
bind_rows(registered)
all
registered <- df_input %>%
filter(registered==1) %>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk))
all<- df_input%>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk)) %>%
bind_rows(registered)
all<-as.data.frame(all)
all
all.count <-all %>% select(-n)
all.count
all.perc <- all  %>%
mutate(round(ctv3=ctv3/n*100,0),round(primis=primis/n*100,0),round(primis_unk=primis_unk/n*100,0))
all.perc <- all  %>%
mutate(ctv3=round(ctv3/n*100,0),primis=round(primis/n*100,0),primis_unk=round(primis_unk/n*100,0))
all.perc
all.perc <- all  %>%
mutate(ctv3=round(ctv3/n*100,0),primis=round(primis/n*100,0),primis_unk=round(primis_unk/n*100,0)) %>%
select(-n)
### count non-missing ethnicities for CTV3 and Primis codelist
library('tidyverse')
fs::dir_create(here::here("output"))
df_input <- read_csv(here::here("output","input.csv.gz")) %>%
mutate(ethnicity_snomed_5=ifelse(ethnicity_snomed_5==0,NA, ethnicity_snomed_5),
total_ctv3 = ifelse(is.na(ethnicity_5),1, 0),
total_primis = ifelse(is.na(ethnicity_snomed_5), 1, 0),
total_primis_unk = ifelse(is.na(ethnicity_primis_5_unk), 1, 0)
)
registered <- df_input %>%
filter(registered==1) %>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk))
all<- df_input %>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk)) %>%
bind_rows(registered)
all_perc <- all  %>%
mutate(ctv3=round(ctv3/n*100,0),primis=round(primis/n*100,0),primis_unk=round(primis_unk/n*100,0)) %>%
select(-n)
all_count <-all %>% select(-n)
write_csv(all_count,here::here("output","ctv3_primis.csv"))
write_csv(all_perc,here::here("output","ctv3_primis_perc.csv"))
v
all_count
all_perc
all_count <-all
all_perc <- all  %>%
mutate(ctv3=round(ctv3/n*100,0),primis=round(primis/n*100,0),primis_unk=round(primis_unk/n*100,0)) %>%
select(-n)
all_count
df_input <- read_csv(here::here("output","input.csv.gz")) %>%
mutate(ethnicity_snomed_5=ifelse(ethnicity_snomed_5==0,NA, ethnicity_snomed_5),
ethnicity_primis_5_unk=ifelse(ethnicity_primis_5_unk==0,NA, ethnicity_primis_5_unk),
total_ctv3 = ifelse(is.na(ethnicity_5),1, 0),
total_primis = ifelse(is.na(ethnicity_snomed_5), 1, 0),
total_primis_unk = ifelse(is.na(ethnicity_primis_5_unk), 1, 0)
)
registered <- df_input %>%
filter(registered==1) %>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk))
all<- df_input %>%
summarise(n=n(),ctv3=sum(total_ctv3),primis=sum(total_primis),primis_unk=sum(total_primis_unk)) %>%
bind_rows(registered)
all_perc <- all  %>%
mutate(ctv3=round(ctv3/n*100,0),primis=round(primis/n*100,0),primis_unk=round(primis_unk/n*100,0)) %>%
select(-n)
all_count <-all
all_count
all_perc
df_input <- read_csv(here::here("output","input.csv.gz")) %>%
mutate(ethnicity_snomed_5=ifelse(ethnicity_snomed_5==0,NA, ethnicity_snomed_5),
ethnicity_primis_5_unk=ifelse(ethnicity_primis_5_unk==0,NA, ethnicity_primis_5_unk),
total_ctv3 = ifelse(is.na(ethnicity_5),1, 0),
total_primis = ifelse(is.na(ethnicity_snomed_5), 1, 0),
total_primis_unk = ifelse(is.na(ethnicity_primis_5_unk), 1, 0)
)
View(df_input)
>>>>>>> Stashed changes
